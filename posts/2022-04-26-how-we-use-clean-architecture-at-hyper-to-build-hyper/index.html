<!DOCTYPE html>
<html lang="en" data-theme="fantasy">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Tyler Hall - Fullstack Web Developer</title>
    <base href="/">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Tyler Hall - Web Developer, hyper Core team, Open Source Project Maintainer">
    <meta name="keywords" content="Tyler Hall, Blog, JavaScript, Hyper, GraphQL, Deno, Svelte, React, ADT, Functional">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/theme-change@2.0.2/index.js"></script>  
  <link rel="stylesheet" href="/assets/asset.0f2deb57.css"></link>
</head>

  <body>
    <div class="navbar bg-base-100">
  <div class="flex-1">
    <div class="flex justify-center space-around py-2 space-x-4">
      <a href="/" class="font-bold">Tyler Hall</a>
    </div>
  </div>
  <div class="flex-none">
    <ul class="menu menu-horizontal p-0 space-around space-x-4">
      <li>
        <a role="button" href="/about" title="About Me" class="">
  
          About
        
</a>
      </li>
      <div title="Change Theme" class="dropdown dropdown-end">
  <div tabindex="0" class="btn gap-2 normal-case btn-ghost">
    <!-- Swatch -->
    <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block h-5 w-5 stroke-current md:h-6 md:w-6">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01">
      </path>
    </svg>
    <span class="hidden md:inline">Change Theme</span>
    <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792" class="ml-1 inline-block h-4 w-4 fill-current">
      <path d="M1395 736q0 13-10 23l-466 466q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l393 393 393-393q10-10 23-10t23 10l50 50q10 10 10 23z">
      </path>
    </svg>
  </div>
  <div class="dropdown-content bg-base-200 text-base-content rounded-t-box rounded-b-box top-px h-96 w-52 overflow-y-auto shadow-2xl mt-16">
    <ul class="menu menu-compact p-4" tabindex="0">
      <li><button data-set-theme="fantasy" data-act-class="active" class="active">🧚‍♀️  fantasy</button></li>
      <li><button data-set-theme="black" data-act-class="active">🏴  black</button></li>
      <li><button data-set-theme="lisght" data-act-class="active">🌝  light</button></li>
      <li><button data-set-theme="dark" data-act-class="active">🌚  dark</button></li>
      <li><button data-set-theme="cupcake" data-act-class="active" class="">🧁  cupcake</button></li>
      <li><button data-set-theme="bumblebee" data-act-class="active" class="">🐝  bumblebee</button></li>
      <li><button data-set-theme="emerald" data-act-class="active" class="">✳️  Emerald</button></li>
      <li><button data-set-theme="corporate" data-act-class="active" class="">🏢  Corporate</button></li>
      <li><button data-set-theme="synthwave" data-act-class="active">🌃  synthwave</button></li>
      <li><button data-set-theme="retro" data-act-class="active" class="">👴  retro</button></li>
      <li><button data-set-theme="cyberpunk" data-act-class="active" class="">🤖  cyberpunk</button></li>
      <li><button data-set-theme="valentine" data-act-class="active" class="">🌸  valentine</button></li>
      <li><button data-set-theme="halloween" data-act-class="active" class="">🎃  halloween</button></li>
      <li><button data-set-theme="garden" data-act-class="active">🌷  garden</button></li>
      <li><button data-set-theme="forest" data-act-class="active">🌲  forest</button></li>
      <li><button data-set-theme="aqua" data-act-class="active">🐟  aqua</button></li>
      <li><button data-set-theme="lofi" data-act-class="active">👓  lofi</button></li>
      <li><button data-set-theme="pastel" data-act-class="active">🖍  pastel</button></li>
      <li><button data-set-theme="wireframe" data-act-class="active">📝  Wireframe</button></li>
      <li><button data-set-theme="luxury" data-act-class="active">💎  luxury</button></li>
      <li><button data-set-theme="dracula" data-act-class="active">🧛‍♂️  dracula</button></li>
      <li><button data-set-theme="cmyk" data-act-class="active">🖨  CMYK</button></li>
      <li><button data-set-theme="autumn" data-act-class="active">🍁  Autumn</button></li>
      <li><button data-set-theme="business" data-act-class="active">💼  Business</button></li>
      <li><button data-set-theme="acid" data-act-class="active">💊  Acid</button></li>
      <li><button data-set-theme="lemonade" data-act-class="active">🍋  Lemonade</button></li>
      <li><button data-set-theme="night" data-act-class="active">🌙  Night</button></li>
      <li><button data-set-theme="coffee" data-act-class="active">☕️  Coffee</button></li>
      <li><button data-set-theme="winter" data-act-class="active">❄️  Winter</button></li>
    </ul>
  </div>
</div>

      <li>
        <div>
          <a href="https://github.com/TillaTheHun0" title="GitHub">
            <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="inline-block h-5 w-5 fill-current md:h-6 md:w-6">
              <path d="M256,32C132.3,32,32,134.9,32,261.7c0,101.5,64.2,187.5,153.2,217.9a17.56,17.56,0,0,0,3.8.4c8.3,0,11.5-6.1,11.5-11.4,0-5.5-.2-19.9-.3-39.1a102.4,102.4,0,0,1-22.6,2.7c-43.1,0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1,1.4-14.1h.1c22.5,2,34.3,23.8,34.3,23.8,11.2,19.6,26.2,25.1,39.6,25.1a63,63,0,0,0,25.6-6c2-14.8,7.8-24.9,14.2-30.7-49.7-5.8-102-25.5-102-113.5,0-25.1,8.7-45.6,23-61.6-2.3-5.8-10-29.2,2.2-60.8a18.64,18.64,0,0,1,5-.5c8.1,0,26.4,3.1,56.6,24.1a208.21,208.21,0,0,1,112.2,0c30.2-21,48.5-24.1,56.6-24.1a18.64,18.64,0,0,1,5,.5c12.2,31.6,4.5,55,2.2,60.8,14.3,16.1,23,36.6,23,61.6,0,88.2-52.4,107.6-102.3,113.3,8,7.1,15.2,21.1,15.2,42.5,0,30.7-.3,55.5-.3,63,0,5.4,3.1,11.5,11.4,11.5a19.35,19.35,0,0,0,4-.4C415.9,449.2,480,363.1,480,261.7,480,134.9,379.7,32,256,32Z"></path>
            </svg>
          </a>
        </div>
      </li>
    </ul>
  </div>
</div>
      <main class="flex flex-grow justify-center min-h-screen p-4 mx-auto w-screen max-w-4xl">
        <div class="flex flex-grow justify-center min-h-screen">
    <article class="w-screen max-w-4xl p-8">
      <h1 class="text-primary text-2xl">Clean 🧼 Architecture 🛠 At Hyper ⚡️</h1>

      <span class="font-light text-sm bg-accent text-accent-content my-2">
        April 26, 2022 - 7 min read
      </span>

      <div class="divider"></div>

      <p>With the <a href="https://blog.hyper.io/hyper-cloud-beta-is-a-go/">beta launch of hyper cloud</a>, I want to share a little bit about how hyper itself works under the hood, and how we leveraged the architecture to build tools that we use to build hyper, <em>with</em> hyper.</p><blockquote>
<p>We are currently offering <a href="https://calendly.com/hyper-cloud/hyper-cloud-technical-tour">hyper cloud tours</a> and a free <a href="https://calendly.com/hyper-cloud/chat-with-an-architect">Architecture Consultation</a>, If you think we could help you build your next great project, let us know!</p>
</blockquote><h2 id="clean-architecture-">Clean Architecture 🧼🛠</h2><p>At Hyper, we embrace the <a href="https://blog.hyper.io/the-perfect-application-architecture/">Clean Architecture</a> approach to building software. This means separating side effects from business logic and working hard to keep business logic separated from other components.</p><p>What is business logic? It’s your secret sauce; the data models that may interact with each other, and the <em>rules</em> that govern how those models interact with each other. <strong>It is not a database, and it is not a frontend framework</strong>. Those pieces are <em>side effects</em> that tie <em>into</em> your business logic. As Robert C. Martin, author of Clean Architecture put it:</p><blockquote>
<p>there is <strong>nothing</strong> architecturally significant about arranging data in rows within tables</p>
</blockquote><p><img src="https://blog.hyper.io/content/images/2022/04/Overview_of_a_three-tier_application_vectorVersion.svg" alt="Overview_of_a_three-tier_application_vectorVersion">
Source: <a href="https://en.wikipedia.org/wiki/Business_logic">https://en.wikipedia.org/wiki/Business_logic</a></p><p>I won’t go into great detail here, there are tons of material on this topic. We encourage teams to build software using the tenants of “Clean Architecture” and we’ve built hyper to encourage doing just that. And not only do we encourage teams to build software using the tenants of Clean Architecture, but this is also how we architected hyper, internally.</p><h2 id="under-the-hood-">Under The Hood 🚘</h2><p>Hyper is built using a ”<a href="https://en.wikipedia.org/wiki/Hexagonal_architecture_(software)">Ports and Adapters</a>” approach.</p><p>The general idea with Ports and Adapters is that the business logic layer defines the models and rules on how they interact with each other, and also a set of consumer-agnostic entry and exit points to and from the business layer. These entry and exit points are called “Ports”. All components <em>external</em> to the business layer, interact by way and are interacted <em>with</em>, the Ports. A Port defines an api but knows nothing about the mechanism or the impetus. Those two things are an Adapter’s job.</p><p>Adapters perform the actual communication between external actors and the business layer. There are generally two types of Adapters: “Driving Adapters” and “Driven Adapters”.</p><p>A driving adapter calls into the business layer, by way of a Port. The driving adapters can generally be thought of as the “presentation layer”. It could be a web application, a desktop application, a <em>CLI</em>, anything that initiates some action on the business domain.</p><p>A driven adapter is called by the business layer, to interact with some backend tool, ie. a database, storage bucket, cache, etc. The business layer calls into the driven adapter by way of the Port. <strong>Driven adapters implement the Port defined by the business layer</strong>.</p><p>So the flow generally looks like</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">Driving Adapter &lt;--&gt; Port &lt;--&gt; Business Layer &lt;--&gt; Port &lt;--&gt; Driven Adapter</span></span></code></pre><p><img src="https://blog.hyper.io/content/images/2022/04/1-9B1EsZPbhElSEFDZU3IpXA.png" alt="1-9B1EsZPbhElSEFDZU3IpXA"></p><p>Source: <a href="https://betterprogramming.pub/hexagonal-architecture-for-ios-part-1-600441c186b7">https://betterprogramming.pub/hexagonal-architecture-for-ios-part-1-600441c186b7</a></p><h3 id="benefits">Benefits</h3><p>Because the business layer enforces the Ports, and all external interactions with external components happens through the Ports, the business layer is encapsulated. The benefits of this for the system cannot be overstated.</p><p>It means the business layer, the models and the rules governing them, can be developed <em>before</em> choosing things like a database, or a frontend framework. Better yet, the business layer can be <em>tested</em> before choosing any of those things. <strong>Covering business logic almost entirely with unit tests is a boon for confidence in the system.</strong></p><blockquote>
<p>When building software, a decision is a set of <em>constraints</em>, and ideally the pros of accepting those constraints outweigh the cons. So we ought to defer accepting constraints until we have as much information as possible to inform that decision. Clean Architecture enables us to do just that.</p>
</blockquote><p>It also allows for the separation of concerns. Each tier of the architecture can change without requiring changes in the other tiers. This is important because some tiers are more volatile than others; typically the UI of an application changes faster than business rules for example.</p><blockquote>
<p>The only time we must touch multiple tiers is if a Port is changed. And that is usually a find and replace</p>
</blockquote><h2 id="hyper-clean-architecture-lingua-franca-">Hyper Clean Architecture Lingua Franca 📚</h2><p><img src="https://blog.hyper.io/content/images/2022/04/hyper-architecture.png" alt="hyper-architecture"></p><h3 id="hyper-apps-">Hyper Apps 🎮</h3><p>The Driving Adapters in the Hyper Service Framework are called “Apps” or “Apis”. We currently have two Apps available shown <a href="https://nest.land/gallery?search=hyper-app">here</a>. The GraphQL app will need to be overhauled eventually, but the Opine app is up to date and provides a RESTful api.</p><p>In the future, we would like to see more app offerings. A CLI app, a GRPC app, we’ve even discussed a Service Worker app, so that Hyper could be run entirely in the browser, on a Service Worker 😎.</p><h3 id="hyper-core-">Hyper Core 🪨</h3><p>The business layer in Hyper is called <a href="https://nest.land/package/hyper">core</a> which contains all of the business logic and enforces each Port. Core also defines the Port that a Hyper App calls.</p><h3 id="hyper-ports-">Hyper Ports 🔌</h3><p>There are multiple Ports defined in the Hyper Service Framework. You can see them all <a href="https://nest.land/gallery?search=hyper-port">here</a>.</p><h3 id="hyper-adapters-">Hyper Adapters 🛠</h3><p>The Driven Adapters in the Hyper Service Framework are simply called “Adapters”. You can see many of them <a href="https://nest.land/gallery?search=hyper-adapter">here</a>. Each adapter implements a Port api and does the heavy lifting of communicating with an underlying component.</p><h3 id="hyper-services">Hyper Services</h3><p>A Hyper Service is combination of the components described above:</p><ul>
<li>A Hyper App</li>
<li>Hyper Core</li>
<li>An Adapter Port</li>
<li>A Hyper Adapter</li>
</ul><p>For example, a Hyper Data Service might be:</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">RESTful api -&gt; Core -&gt; Data Port -&gt; CouchDB Adapter</span></span>
<span class="line"><span style="color: #c9d1d9">// or</span></span>
<span class="line"><span style="color: #c9d1d9">GraphQL api -&gt; Core -&gt; Data Port -&gt; Postgres Adapter</span></span>
<span class="line"><span style="color: #c9d1d9">// or</span></span>
<span class="line"><span style="color: #c9d1d9">CLI -&gt; Core -&gt; Data Port -&gt; DynamoDB Adapter</span></span></code></pre><p>A Hyper Cache Service might be:</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">GRPC api -&gt; Core -&gt; Cache Port -&gt; Redis Adapter</span></span>
<span class="line"><span style="color: #c9d1d9">// or</span></span>
<span class="line"><span style="color: #c9d1d9">GraphQL api -&gt; Core -&gt; Cache Port -&gt; Sqlite Adapter</span></span>
<span class="line"><span style="color: #c9d1d9">// or</span></span>
<span class="line"><span style="color: #c9d1d9">CLI -&gt; Core -&gt; Cache Port -&gt; FlatFile Adapter</span></span></code></pre><p>A Hyper Search Service might:</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">GRPC api -&gt; Core -&gt; Search Port -&gt; Elasticsearch Adapter</span></span>
<span class="line"><span style="color: #c9d1d9">// or</span></span>
<span class="line"><span style="color: #c9d1d9">RESTful api -&gt; Core -&gt; Search Port -&gt; Minisearch Adapter</span></span>
<span class="line"><span style="color: #c9d1d9">// or</span></span>
<span class="line"><span style="color: #c9d1d9">CLI -&gt; Core -&gt; Search Port -&gt; Algolia Adapter</span></span></code></pre><p>I hope you’re noticing something:</p><p><strong>Adapters and Apps are <em>interchangeable</em></strong>. This is how we can test our business layer without choosing a database, for example. We just mock the Adapter that communicates with the database.</p><p><strong>This also means we can run the Hyper Service Framework using a set of “local development” adapters.</strong></p><h2 id="hyper-nano-">Hyper Nano 🍷</h2><p><a href="https://github.com/hyper63/hyper/tree/main/images/nano">Hyper Nano</a> is the compiled Hyper Service Framework using a set of “local development” adapters. It’s the same Hyper RESTful app, and the same Hyper Core, but with a set of adapters that allow it to run locally sandboxed, and simple to quickly spin up and then blow away.</p><ul>
<li>data (powered by <a href="https://github.com/hyper63/hyper-adapter-pouchdb">PouchDB</a>)</li>
<li>cache (powered by <a href="https://github.com/hyper63/hyper-adapter-sqlite">Sqlite</a>)</li>
<li>storage (powered by your local <a href="https://github.com/hyper63/hyper-adapter-fs">file system</a>)</li>
<li>search (powered by <a href="https://github.com/hyper63/hyper-adapter-minisearch">Sqlite and Minisearch</a>)</li>
<li>queue (powered by <a href="https://github.com/hyper63/hyper-adapter-queue">DnDB and an in-memory queue</a>)</li>
</ul><p>Hyper Nano is great for development or sandboxed short-lived environments ie. GitHub Workspaces or GitPod.</p><p>Hyper Nano has some other features that we will cover in another blog post.</p><p>At hyper, we use Hyper Nano to develop hyper products. When building <a href="https://dashboard.hyper.io">hyper cloud</a>, we simply spin up a Gitpod Workspace, which installs our dependencies, starts Hyper Nano, and bootstraps our services. The result is a completely sandboxed local development environment in Cloud 😎 ☁️⚡️. Yes, we use <strong>hyper</strong> to build <strong>hyper</strong>.</p><p>Then in deployed environments, we use the Hyper Service Framework, but with actual Adapters to actual external services. <strong>Our interactions with Hyper does not change between Hyper Cloud and Hyper Nano</strong></p><h2 id="conclusion">Conclusion</h2><p>We try to practice what we preach, we dogfood practically everything we build, and hopefully, this provides some insights on how Hyper works internally and why you might consider trying Clean Architecture and Hyper.</p><p>We are currently offering <a href="https://calendly.com/hyper-cloud/hyper-cloud-technical-tour">hyper cloud tours</a> and a free <a href="https://calendly.com/hyper-cloud/chat-with-an-architect">Architecture Consultation</a>, If you think we could help you build your next great project, let us know!</p><h2 id="acknowledgements">Acknowledgements</h2><ul>
<li><a href="https://en.wikipedia.org/wiki/Business_logic">https://en.wikipedia.org/wiki/Business_logic</a> for the 3 tier architecture graphic</li>
<li>Oleksandr Stepanov’s <a href="https://betterprogramming.pub/hexagonal-architecture-for-ios-part-1-600441c186b7">awesome post</a> on Hexagonal Architecture, which provides some great visualizations of the architecture</li>
</ul>
    </article>  
  </div>
      </main>
    <footer>
  <div class="bg-accent py-4 flex justify-center">
    <div class="text-white">
      <a href="https://github.com/TillaTheHun0/astro-blog">Source Code</a> - © Copyright 2022
    </div>
  </div>
</footer>
  </body></html>
